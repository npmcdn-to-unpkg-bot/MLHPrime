<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>MLH Prime</title>
        <script src="phaser.js"></script>
    </head>
    <body>
    <!--Load twilio client sdk-->
    <script src="https://media.twiliocdn.com/sdk/js/common/v0.1/twilio-common.min.js"></script>
    <script src="https://media.twiliocdn.com/sdk/js/sync/v0.2/twilio-sync.min.js"></script>

    <!--http client-->
    <script src="https://npmcdn.com/axios/dist/axios.min.js"></script>

    <script src="javascripts/sync.js"></script>

    <script type="text/javascript">

    window.onload = function() {

        //  Note that this html file is set to pull down Phaser 2.5.0 from the JS Delivr CDN.
        //  Although it will work fine with this tutorial, it's almost certainly not the most current version.
        //  Be sure to replace it with an updated version before you start experimenting with adding your own code.

        var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });
        var cursors;
        var player;

        var background1;

        function preload () {
            game.load.spritesheet('player', 'assets/player.png', 14, 21);

            game.load.image('tileset', 'assets/background.png')
            game.load.image('background', 'assets/background.png');
        }

        function create () {
            game.physics.startSystem(Phaser.Physics.ARCADE);

            background = game.add.tileSprite(0, 0, game.world.width, game.world.height, 'background');
            player = game.add.sprite(32, game.world.centerY, 'player');
            player.anchor.setTo(0.5, 0.5);

            game.physics.arcade.enable(player);
            player.animations.add('right', [0, 1, 2, 3], 12, true);
            player.animations.add('left', [4, 5, 6, 7], 12, true);
            player.animations.add('up', [8, 9, 10, 11], 12, true);
            player.animations.add('down', [12, 13, 14, 15], 12, true);

            cursors = game.input.keyboard.createCursorKeys();
        }

        function update () {

            player.body.velocity.y = 0;
            player.body.velocity.x = 0;
            console.log(player.x + " " + player.y);

            if(cursors.up.isDown)
            {
                if(player.y > 0) player.body.velocity.y = -100;
                if(player.dirX == 0) player.animations.play('up');
                player.dirY = -1;
                if(!cursors.left.isDown && !cursors.right.isDown) {
                    player.dirX = 0;
                }
            }
            else if(cursors.down.isDown) 
            {
                if(player.y < game.height) player.body.velocity.y = 100;
                if(player.dirX == 0) player.animations.play('down');
                player.dirY = 1;
                if(!cursors.left.isDown && !cursors.right.isDown) {
                    player.dirX = 0;
                }
            }
            
            if(cursors.right.isDown)
            {
                if(player.x < game.width) player.body.velocity.x = 100;
                player.animations.play('right');
                player.dirX = 1;
                if(!cursors.up.isDown && !cursors.down.isDown) {
                    player.dirY = 0;
                }
            }
            else if(cursors.left.isDown) 
            {
                if(player.x > 0) player.body.velocity.x = -100;
                player.animations.play('left');
                player.dirX = -1;
                if(!cursors.up.isDown && !cursors.down.isDown) {
                    player.dirY = 0;
                }
            }
            else if(!cursors.up.isDown && !cursors.down.isDown && !cursors.left.isDown && !cursors.right.isDown)
            {
                player.animations.stop();
                if(player.dirX == 1) player.frame = 2;
                else if(player.dirX == -1) player.frame = 5;
                else if(player.dirX == 0) {
                    if(player.dirY == -1) player.frame = 10;
                    else if(player.dirY == 1) player.frame = 13;
                }
            }

        }

    };


    </script>

    </body>
</html>